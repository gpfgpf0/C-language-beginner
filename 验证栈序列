#include<stdio.h>
#include<stdlib.h>
#include<math.h>
#include<ctype.h>
#include<string.h>
#include<time.h>
typedef struct Node
{
    int val;
    struct Node *up;
    struct Node *down;
}*List;
int main()
{    
    int q,n;
    scanf("%d",&q);
    while(q--)
    {
        List d=(List)malloc(sizeof(struct Node));
        List p=NULL,u=d;
        d->val=-1;
        d->down=NULL;
        d->up=NULL;
        int tmp,i;
        scanf("%d",&n);
        for(i=0;i<n;i++)
        {
            scanf("%d",&tmp);
            if(u->val==-1)
            u->val=tmp;
            else
            {
                p=(List)malloc(sizeof(struct Node));
                p->up=NULL;
                p->val=tmp;
                p->down=u;
                u->up=p;
                u=p;
            }
        }
        p=d;
        for(i=0;i<n;i++)
        {
            scanf("%d",&tmp);
            while(p&&tmp!=p->val)
            p=p->up;
            if(!p)
            {
                i++;
                break;
            }            
            if(p->down==NULL)
            {
                d=p->up;
                if(p->up)
                (p->up)->down=NULL;
                free(p);
                p=d;
            }
            else
            {
                List pp=p->down;
                pp->up=p->up;
                if(p->down)
                {
                    pp->down=(p->down)->down;
                    if(pp->down)
                    (pp->down)->up=pp;
                }
                if(p->up)
                (p->up)->down=pp;
                free(p);
                p=pp;
            }
        }
        if(i<n)
        {
            for(;i<n;i++)
            scanf("%d",&tmp);
            while(d)
            {
                p=d->up;
                free(d);
                d=p;
            }
            printf("No\n");
        }
        else
        printf("Yes\n");
    }
    return 0;
}
